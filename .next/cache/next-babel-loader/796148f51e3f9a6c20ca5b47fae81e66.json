{"ast":null,"code":"import _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nvar __jsx = React.createElement;\nimport * as React from 'react';\nimport Auth from '../../containers/Auth/Auth';\nimport { AuthContext } from '../../context/authContext';\nimport { PortfolioContext, TPortfolioActionTypes } from '../../context/portfolioContext';\nimport PortfolioItems from '../../components/Admin/PortfolioManagement/Portfolio';\nimport Loading from '../../components/UI/Loading/Loading';\n\nconst css = require('./Admin.module.css');\n\nconst Admin = () => {\n  const authContext = React.useContext(AuthContext);\n  const authState = authContext.state;\n  const authDispatch = authContext.dispatch;\n  const [sending, setSending] = React.useState(true);\n  const [screensize, setScreensize] = React.useState();\n  React.useEffect(() => {\n    document.title = 'Portfolio // Admin';\n    setScreensize({\n      width: window.innerWidth,\n      height: window.innerHeight\n    });\n\n    if (localStorage.length !== 0) {\n      // check for auth info in local storage\n      // compare current time in milliseconds to expire time in storage\n      // if current time is LESS, use the auth info from storage to refresh\n      // else, clear local storage\n      const expireTime = localStorage.getItem('expireTime');\n\n      if (expireTime) {\n        // if auth token has not expired yet\n        if (new Date().getTime() < +expireTime) {\n          const authInfo = {\n            email: localStorage.getItem('email'),\n            password: localStorage.getItem('password'),\n            idToken: localStorage.getItem('idToken')\n          };\n          authDispatch({\n            type: 'signin',\n            payload: authInfo\n          });\n          setSending(false); // if auth has expired\n        } else {\n          localStorage.clear();\n          setSending(false);\n        }\n      }\n    } else {\n      setSending(false);\n    }\n  }, []);\n\n  const signInHandler = (email, password, idToken) => {\n    const authInfo = {\n      email: email,\n      password: password,\n      idToken: idToken\n    };\n    authDispatch({\n      type: 'signin',\n      payload: authInfo\n    });\n  };\n\n  return __jsx(\"div\", {\n    className: css.Main,\n    style: {\n      minHeight: `${screensize === null || screensize === void 0 ? void 0 : screensize.height}px`,\n      minWidth: `${screensize === null || screensize === void 0 ? void 0 : screensize.width}px`\n    }\n  }, !authState.signedIn && __jsx(Auth, {\n    setSending: setSending,\n    signIn: signInHandler\n  }), authState.signedIn && __jsx(AdminContent, {\n    token: authState.idToken\n  }), __jsx(Loading, {\n    show: sending,\n    transparent: true,\n    fadeout: true\n  }));\n};\n\nconst AdminContent = () => {\n  const portfolioContext = React.useContext(PortfolioContext);\n  const portfolioState = portfolioContext.state;\n  const portfolioDispatch = portfolioContext.dispatch;\n  const [loading, setLoading] = React.useState(true);\n  React.useEffect(() => {\n    if (portfolioState.items.length === 0) {\n      const baseURL = 'https://joonajo-portfolio.firebaseio.com/items.json';\n      const newItems = [];\n      fetch(baseURL, {\n        method: 'get'\n      }).then(response => response.json()).then(data => {\n        if (data) {\n          _Object$keys(data).forEach(item => {\n            newItems.push(data[item]);\n          });\n\n          portfolioDispatch({\n            type: TPortfolioActionTypes.SET_ITEMS,\n            payload: newItems\n          });\n        }\n\n        setLoading(false);\n      });\n    } else {\n      setLoading(false);\n    }\n  }, [portfolioState]);\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: css.AdminContentWrapper\n  }, !loading && __jsx(PortfolioItems, {\n    items: portfolioState.items\n  })), __jsx(Loading, {\n    show: loading,\n    transparent: true,\n    fadeout: true\n  }));\n};\n\nexport default Admin;","map":null,"metadata":{},"sourceType":"module"}