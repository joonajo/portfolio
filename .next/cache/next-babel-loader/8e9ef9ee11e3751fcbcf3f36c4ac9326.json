{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _slicedToArray from \"@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport * as React from 'react';\nimport { googleKey } from '../../keys';\nimport { icons } from '../../icons/icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nvar css = require('./Auth.module.css');\n\nvar Auth = function Auth(_ref) {\n  var setSending = _ref.setSending,\n      signIn = _ref.signIn;\n\n  var _React$useState = React.useState({\n    error: false\n  }),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      error = _React$useState2[0],\n      setError = _React$useState2[1];\n\n  var signInHandler = function signInHandler(email, password) {\n    setSending(true);\n    var baseURL = \"https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword\";\n    var apiKey = \"?key=\".concat(googleKey);\n\n    var payload = _JSON$stringify({\n      email: email,\n      password: password,\n      returnSecureToken: true\n    });\n\n    fetch(baseURL + apiKey, {\n      method: 'post',\n      body: payload\n    }).then(function (response) {\n      return response.json();\n    }).then(function (data) {\n      if (data.error) {\n        setError({\n          error: true,\n          errorInfo: {\n            code: data.error.code,\n            message: data.error.message\n          }\n        });\n        setSending(false);\n      } else {\n        // console.log(data)\n        var _idToken = data === null || data === void 0 ? void 0 : data.idToken;\n\n        var refreshToken = data === null || data === void 0 ? void 0 : data.refreshToken;\n\n        var _email = data === null || data === void 0 ? void 0 : data.email;\n\n        var _password = data === null || data === void 0 ? void 0 : data.password;\n\n        var expireTime = String(new Date().getTime() + (data === null || data === void 0 ? void 0 : data.expiresIn) * 1000);\n        localStorage.setItem('idToken', _idToken);\n        localStorage.setItem('refreshToken', refreshToken);\n        localStorage.setItem('password', _password);\n        localStorage.setItem('email', _email);\n        localStorage.setItem('expireTime', expireTime);\n        setSending(false);\n        setError({\n          error: false\n        });\n        signIn(_email, _password, _idToken);\n      }\n    });\n  };\n\n  return __jsx(\"div\", {\n    className: css.Container\n  }, __jsx(AuthForm, {\n    submit: signInHandler,\n    error: error\n  }));\n};\n\nvar initialAuthFormState = {\n  email: {\n    id: 'email',\n    inputType: 'email',\n    placeholder: 'email',\n    require: true,\n    value: '',\n    className: css.EmailInput,\n    icon: {\n      focus: icons.faEnvelopeOpen,\n      unfocus: icons.faEnvelope\n    }\n  },\n  password: {\n    id: 'password',\n    inputType: 'password',\n    placeholder: 'password',\n    require: true,\n    value: '',\n    className: css.PasswordInput,\n    icon: {\n      focus: icons.faUnlock,\n      unfocus: icons.faLock\n    }\n  }\n};\n\nvar AuthForm = function AuthForm(_ref2) {\n  var _error$errorInfo;\n\n  var submit = _ref2.submit,\n      error = _ref2.error;\n\n  var _React$useState3 = React.useState(initialAuthFormState),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      formState = _React$useState4[0],\n      setFormState = _React$useState4[1];\n\n  React.useEffect(function () {\n    var keyHandler = function keyHandler(event) {\n      if (event.key === 'Enter') {\n        signInHandler();\n      }\n    };\n\n    window.addEventListener('keydown', keyHandler, true);\n    return function () {\n      return window.removeEventListener('keydown', keyHandler, true);\n    };\n  }, [formState]);\n\n  var changeHandler = function changeHandler(elemKey, event) {\n    var updatedFormState = _objectSpread({}, formState, _defineProperty({}, elemKey, _objectSpread({}, formState[elemKey], {\n      value: event.target.value\n    })));\n\n    setFormState(updatedFormState);\n  };\n\n  var signInHandler = function signInHandler() {\n    submit(formState.email.value, formState.password.value);\n  };\n\n  return __jsx(\"div\", {\n    className: css.AuthFormContainer\n  }, __jsx(\"form\", {\n    className: css.AuthForm\n  }, _Object$keys(formState).map(function (elementKey) {\n    return __jsx(InputComponent, _extends({\n      key: elementKey\n    }, formState[elementKey], {\n      changed: changeHandler\n    }));\n  })), (error === null || error === void 0 ? void 0 : error.error) && __jsx(\"p\", {\n    className: css.ErrorText\n  }, (_error$errorInfo = error.errorInfo) === null || _error$errorInfo === void 0 ? void 0 : _error$errorInfo.message), __jsx(\"div\", {\n    className: css.SubmitButton,\n    onClick: signInHandler\n  }, __jsx(\"p\", null, \"Sign In\"), __jsx(FontAwesomeIcon, {\n    icon: icons.faSignInAlt\n  })));\n};\n\nvar InputComponent = function InputComponent(props) {\n  var _props$icon;\n\n  var _React$useState5 = React.useState(false),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      isFocused = _React$useState6[0],\n      setIsFocused = _React$useState6[1];\n\n  var containerClasses = [css.InputContainer, isFocused && css.focus].join(' ');\n  var iconClasses = [css.InputIcon, isFocused && css.focus].join(' ');\n  var spanClasses = [css.Span, isFocused && css.focus].join(' ');\n  return __jsx(\"div\", {\n    className: containerClasses\n  }, props.icon && __jsx(\"div\", {\n    className: css.IconContainer\n  }, __jsx(FontAwesomeIcon, {\n    className: iconClasses,\n    icon: (_props$icon = props.icon) === null || _props$icon === void 0 ? void 0 : _props$icon.unfocus\n  })), __jsx(\"input\", {\n    className: props.className,\n    placeholder: !isFocused ? props.placeholder : '',\n    value: props.value,\n    type: props.inputType,\n    onChange: function onChange(e) {\n      return props.changed(props.id, e);\n    },\n    onFocus: function onFocus() {\n      return setIsFocused(true);\n    },\n    onBlur: function onBlur() {\n      return setIsFocused(false);\n    }\n  }), __jsx(\"span\", {\n    className: spanClasses\n  }));\n};\n\nexport default Auth;","map":null,"metadata":{},"sourceType":"module"}